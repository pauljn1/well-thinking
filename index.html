<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Well Thinking - Slide Builder</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

<header>
    <h1><i class="fa-solid fa-sliders"></i> ADELIE LA BOSS</h1>
</header>

    <main>
        <section id="toolbar">
            <div class="tool-category">Types de Slides</div>
            <div class="draggable-item" draggable="true">
                <i class="fa-solid fa-align-left" style="color:var(--primary-color)"></i> Texte Simple
            </div>
            <div class="draggable-item" draggable="true">
                <i class="fa-regular fa-circle-question" style="color:var(--primary-color)"></i> Question Quizz
            </div>
            <div class="draggable-item" draggable="true">
                <i class="fa-solid fa-trophy" style="color:#f1c40f"></i> Fin / Victoire
            </div>
        </section>

        <section id="canvas-container">
            
            <div class="node" style="top: 50px; left: 50px;">
                <div class="node-header">
                    <span>#1 Introduction</span>
                    <i class="fa-solid fa-play"></i>
                </div>
                <div class="node-body">
                    "Bienvenue dans ce module de formation."
                </div>
                <div class="node-ports">
                    <div class="port">
                        <span>Suivant</span>
                        <div class="socket"></div> </div>
                </div>
            </div>

            <div class="node" style="top: 50px; left: 400px;">
                <div class="node-header">
                    <span>#2 Le Dilemme</span>
                    <i class="fa-solid fa-question-circle"></i>
                </div>
                <div class="node-body">
                    <strong>Q:</strong> Quelle est la bonne pratique ?
                </div>
                <div class="node-ports">
                    <div class="port">
                        <span style="color:var(--success-color)">A. Faire une sauvegarde</span>
                        <div class="socket success" title="Connecter vers la suite"></div>
                    </div>
                    <div class="port">
                        <span style="color:var(--danger-color)">B. Tout supprimer</span>
                        <div class="socket failure" title="Connecter vers l'√©chec"></div>
                    </div>
                </div>
            </div>

            <div class="node" style="top: 300px; left: 400px; border-color: var(--danger-color)">
                <div class="node-header" style="background: var(--danger-color)">
                    <span>#3 √âchec</span>
                    <i class="fa-solid fa-skull"></i>
                </div>
                <div class="node-body">
                    "Mauvaise r√©ponse. Recommencez."
                </div>
            </div>

    </section>

</main>

    <script type="module" src="src/main.js"></script>
</body>
</html>

<script>
let slideCount = document.querySelectorAll(".slide").length;
let selectedSlide = null;

/* =========================
   SELECTION DES SLIDES
========================= */
document.addEventListener("click", (e) => {
    const slide = e.target.closest(".slide");

    document.querySelectorAll(".slide").forEach(s => {
        s.style.outline = "none";
    });

    if (slide) {
        selectedSlide = slide;
        slide.style.outline = "3px solid var(--primary)";
    } else {
        selectedSlide = null;
    }
});

/* =========================
   AJOUT SLIDE
========================= */
document.getElementById("btn-add").addEventListener("click", () => {
    slideCount++;

    const slide = document.createElement("div");
    slide.className = "slide";
    slide.style.top = "300px";
    slide.style.left = "500spx";

    slide.innerHTML = `
        <div class="slide-header">
            <span>Slide </span>
            <i class="fa-solid fa-grip"></i>
        </div>
    `;

    document.getElementById("canvas-container").appendChild(slide);
});

/* =========================
   SUPPRESSION SLIDE
========================= */
document.getElementById("btn-delete").addEventListener("click", () => {
    if (!selectedSlide) {
        alert("S√©lectionne une slide √† supprimer üôÇ");
        return;
    }

    selectedSlide.remove();
    selectedSlide = null;
});

// SUPPRESSION AVEC TOUCHE DELETE
document.addEventListener("keydown", (e) => {
    // V√©rifie si une slide est s√©lectionn√©e
    if (!selectedSlide) return;

    // e.key peut √™tre "Delete" ou "Backspace"
    if (e.key === "Delete" || e.key === "Backspace") {
        selectedSlide.remove();
        selectedSlide = null;
    }
});
/* =========================
   DUPLIQUER LA SLIDE SELECTIONN√âE
========================= */

document.getElementById("btn-duplicate").addEventListener("click", () => {
    if (!selectedSlide) {
        alert("S√©lectionne une slide √† dupliquer üôÇ");
        return;
    }

    // Clone la slide
    const clone = selectedSlide.cloneNode(true);

    // D√©caler l√©g√®rement la position pour qu'on voie le clone
    const left = parseInt(selectedSlide.style.left || 0);
    const top = parseInt(selectedSlide.style.top || 0);
    clone.style.left = (left + 40) + "px";
    clone.style.top = (top + 40) + "px";

    // Ajouter le clone au canvas
    document.getElementById("canvas-container").appendChild(clone);

    // Mettre √† jour la s√©lection pour le clone
    document.querySelectorAll(".slide").forEach(s => s.style.outline = "none");
    selectedSlide = clone;
    clone.style.outline = "3px solid var(--primary)";
});
/* =========================
   NOUVEAU PROJET
========================= */
document.getElementById("btn-new-project").addEventListener("click", () => {
    const canvas = document.getElementById("canvas-container");

    // Supprime toutes les slides
    canvas.querySelectorAll(".slide").forEach(slide => slide.remove());

    // R√©initialise la s√©lection
    selectedSlide = null;

    // Ajoute une slide initiale vide
    const initialSlide = document.createElement("div");
    initialSlide.className = "slide";
    initialSlide.style.top = "120px";
    initialSlide.style.left = "120px";
    initialSlide.innerHTML = `
        <div class="slide-header">
            <span></span>
            <i class="fa-solid fa-grip"></i>
        </div>
    `;
    canvas.appendChild(initialSlide);
});
/* =========================
   DRAG & DROP SLIDES
========================= */
let isDragging = false;
let offsetX, offsetY;

document.addEventListener("mousedown", (e) => {
    const header = e.target.closest(".slide-header");
    if (!header) return;

    selectedSlide = header.parentElement;
    isDragging = true;

    const rect = selectedSlide.getBoundingClientRect();
    offsetX = e.clientX - rect.left;
    offsetY = e.clientY - rect.top;

    selectedSlide.style.zIndex = 1000;
});

document.addEventListener("mousemove", (e) => {
    if (!isDragging || !selectedSlide) return;

    const canvas = document.getElementById("canvas-container");
    const canvasRect = canvas.getBoundingClientRect();

    selectedSlide.style.left = (e.clientX - canvasRect.left - offsetX) + "px";
    selectedSlide.style.top = (e.clientY - canvasRect.top - offsetY) + "px";
});

document.addEventListener("mouseup", () => {
    isDragging = false;
    if (selectedSlide) selectedSlide.style.zIndex = "";
});




</script>