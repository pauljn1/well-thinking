<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flowpoint - Éditeur</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="app-container">
        <header class="top-bar">
            <div class="logo">
                <a href="home.html" class="back-btn" title="Retour à l'accueil">
                    <i class="fas fa-arrow-left"></i>
                </a>
                <img src="img/flowpoint_logo.png" alt="Flowpoint" style="height: 40px; width: auto;">
            </div>
            
            <div class="toolbar text-tools" id="textTools" style="display: none;">
                <div class="tool-group">
                    <select id="fontSelect" class="font-select">
                        <option value="Inter">Inter</option>
                        <option value="Arial">Arial</option>
                        <option value="Georgia">Georgia</option>
                        <option value="Times New Roman">Times New Roman</option>
                        <option value="Courier New">Courier New</option>
                    </select>
                    <select id="fontSizeSelect" class="font-size-select">
                        <option value="12">12</option>
                        <option value="14">14</option>
                        <option value="16">16</option>
                        <option value="18">18</option>
                        <option value="24" selected>24</option>
                        <option value="32">32</option>
                        <option value="48">48</option>
                        <option value="64">64</option>
                        <option value="72">72</option>
                    </select>
                </div>
                <div class="separator"></div>
                <div class="tool-group">
                    <button class="tool-btn" id="boldBtn" title="Gras"><i class="fas fa-bold"></i></button>
                    <button class="tool-btn" id="italicBtn" title="Italique"><i class="fas fa-italic"></i></button>
                    <button class="tool-btn" id="underlineBtn" title="Souligné"><i class="fas fa-underline"></i></button>
                </div>
                <div class="separator"></div>
                <div class="tool-group">
                    <button class="tool-btn" id="alignLeftBtn"><i class="fas fa-align-left"></i></button>
                    <button class="tool-btn" id="alignCenterBtn"><i class="fas fa-align-center"></i></button>
                    <button class="tool-btn" id="alignRightBtn"><i class="fas fa-align-right"></i></button>
                </div>
                <div class="separator"></div>
                <div class="tool-group">
                    <input type="color" id="textColorPicker" class="color-picker" value="#1e1e1e">
                </div>
            </div>

            <div class="actions">
                <button class="btn btn-secondary" id="saveBtn">
                    <i class="fas fa-cloud-upload-alt"></i>
                    Sauvegarder
                </button>

                <button class="btn btn-secondary" id="exportBtn">
                    <i class="fas fa-download"></i>
                    Exporter
                </button>
                <button class="btn btn-primary" id="presentBtn">
                    <i class="fas fa-play"></i>
                    Présenter
                </button>
            </div>
        </header>

        <div class="main-content">
            <aside class="slides-panel">
                <div class="panel-header">
                    <h3>Diapositives</h3>
                    <div class="add-slide-wrapper">
                        <button class="add-slide-btn" id="addSlideBtn" title="Ajouter une diapositive">
                            <i class="fas fa-plus"></i>
                        </button>
                        <div class="add-slide-dropdown" id="addSlideDropdown">
                            <button class="dropdown-item" data-template="blank"><div class="dropdown-preview blank"></div><span>Vierge</span></button>
                            <button class="dropdown-item" data-template="title"><div class="dropdown-preview title-only"><div class="tpl-title"></div></div><span>Titre</span></button>
                            <button class="dropdown-item" data-template="titleText"><div class="dropdown-preview title-text"><div class="tpl-title"></div><div class="tpl-text"></div></div><span>Titre + Texte</span></button>
                            <button class="dropdown-item" data-template="titleImage"><div class="dropdown-preview title-image"><div class="tpl-title"></div><div class="tpl-image"><i class="fas fa-image"></i></div></div><span>Titre + Image</span></button>
                            <button class="dropdown-item" data-template="twoColumns"><div class="dropdown-preview two-cols"><div class="tpl-title"></div><div class="tpl-cols"><div class="tpl-col"></div><div class="tpl-col"></div></div></div><span>2 Colonnes</span></button>
                            <button class="dropdown-item" data-template="imageText"><div class="dropdown-preview img-text"><div class="tpl-img-left"><i class="fas fa-image"></i></div><div class="tpl-text-right"></div></div><span>Image + Texte</span></button>
                        </div>
                    </div>
                </div>
                
                <div class="view-tabs">
                    <button class="view-tab active" id="listViewBtn" title="Vue liste">
                        <i class="fas fa-list"></i> <span>Liste</span>
                    </button>
                    <button class="view-tab" id="treeFullscreenBtn" title="Vue scénario">
                        <i class="fas fa-project-diagram"></i> <span>Scénario</span>
                    </button>
                </div>
                
                <div class="slides-list" id="slidesList"></div>
            </aside>

            <main class="editor-area">
                <div class="canvas-container">
                    <div class="slide-canvas" id="slideCanvas"></div>
                </div>
                <div class="slide-navigation">
                    <button class="nav-btn" id="prevSlide"><i class="fas fa-chevron-left"></i></button>
                    <span class="slide-counter" id="slideCounter">1 / 1</span>
                    <button class="nav-btn" id="nextSlide"><i class="fas fa-chevron-right"></i></button>
                </div>
                <div class="canvas-nav-arrows">
                    <button class="canvas-arrow arrow-left" id="canvasArrowLeft"><i class="fas fa-arrow-left"></i></button>
                    <button class="canvas-arrow arrow-right" id="canvasArrowRight"><i class="fas fa-arrow-right"></i></button>
                </div>
            </main>

            <aside class="properties-panel" id="propertiesPanel">
                <div class="panel-header"><h3>Propriétés</h3></div>
                <div class="properties-content" id="propertiesContent">
                    <div class="property-section">
                        <h4>Diapositive</h4>
                        <div class="property-row">
                            <label>Fond</label>
                            <input type="color" id="slideBgColor" value="#ffffff">
                        </div>
                    </div>
                    
                    <div class="property-section">
                        <h4>Ajouter un élément</h4>
                        <div class="add-elements-grid">
                            <button class="add-element-btn" id="addTextBtnSide"><i class="fas fa-font"></i><span>Texte</span></button>
                            <button class="add-element-btn" id="addImageBtnSide"><i class="fas fa-image"></i><span>Image</span></button>
                            <button class="add-element-btn" id="addShapeBtnSide"><i class="fas fa-shapes"></i><span>Forme</span></button>
                            <button class="add-element-btn" id="addNavLinkBtnSide"><i class="fas fa-link"></i><span>Navigation</span></button>
                        </div>
                    </div>

                    <div class="property-section element-properties" id="elementProperties" style="display: none;">
                        <h4>Élément sélectionné</h4>
                        <div class="property-row text-content-row" id="textContentRow" style="display: none;">
                            <label>Contenu</label>
                            <textarea id="elemTextContent" rows="3" placeholder="Entrez votre texte..."></textarea>
                        </div>
                        <div class="property-row"><label>Position X</label><input type="number" id="elemX" value="0"></div>
                        <div class="property-row"><label>Position Y</label><input type="number" id="elemY" value="0"></div>
                        <div class="property-row"><label>Largeur</label><input type="number" id="elemWidth" value="100"></div>
                        <div class="property-row"><label>Hauteur</label><input type="number" id="elemHeight" value="100"></div>
                        
                        <div class="property-row navlink-row" id="navLinkRow" style="display: none;">
                            <label>Slide cible</label>
                            <select id="targetSlideSelect"></select>
                        </div>
                        <div class="property-row navlink-row" id="navLinkLabelRow" style="display: none;">
                            <label>Texte</label>
                            <input type="text" id="navLinkLabel">
                        </div>
                        <div class="property-row navlink-row" id="navLinkColorRow" style="display: none;">
                            <label>Couleur</label>
                            <input type="color" id="navLinkColor" value="#cc6699">
                        </div>
                        
                        <div class="property-row shape-row" id="shapeColorRow" style="display: none;">
                            <label>Couleur</label>
                            <input type="color" id="shapeColor" value="#7c3aed">
                        </div>
                        
                        <div class="property-row shape-row" id="shapeRotationRow" style="display: none;">
                            <label> Rotation   </label>
                            <input type="range" id="shapeRotation" min="0" max="360" value="0" style="flex: 1;">
                            <span id="rotationValue" style="width: 50px; text-align: center;">0°</span>
                        </div>

                        <button class="btn btn-danger" id="deleteElement"><i class="fas fa-trash"></i> Supprimer</button>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <div class="modal" id="shapeModal">
        <div class="modal-content">
            <div class="modal-header"><h3>Choisir une forme</h3><button class="close-modal" id="closeShapeModal">&times;</button></div>
            <div class="shapes-grid">
                <button class="shape-option" data-shape="rectangle"><div class="shape-preview rectangle"></div><span>Rectangle</span></button>
                <button class="shape-option" data-shape="circle"><div class="shape-preview circle"></div><span>Cercle</span></button>
                <button class="shape-option" data-shape="triangle"><div class="shape-preview triangle"></div><span>Triangle</span></button>
                <button class="shape-option" data-shape="star"><div class="shape-preview star"></div><span>Étoile</span></button>
                <button class="shape-option" data-shape="arrow"><div class="shape-preview arrow"></div><span>Flèche</span></button>
                <button class="shape-option" data-shape="line"><div class="shape-preview line"></div><span>Ligne</span></button>
            </div>
        </div>
    </div>

    <div class="modal" id="imageModal">
        <div class="modal-content">
            <div class="modal-header"><h3>Ajouter une image</h3><button class="close-modal" id="closeImageModal">&times;</button></div>
            <div class="image-upload-area">
                <input type="file" id="imageInput" accept="image/*" hidden>
                <label for="imageInput" class="upload-label"><i class="fas fa-cloud-upload-alt"></i><span>Cliquez pour sélectionner</span></label>
                <div class="url-input-group">
                    <span class="divider-text">ou</span>
                    <input type="text" id="imageUrlInput" placeholder="URL de l'image...">
                    <button class="btn btn-primary" id="addImageFromUrl">Ajouter</button>
                </div>
            </div>
        </div>
    </div>

    <div class="presentation-mode" id="presentationMode">
        <div class="presentation-slide" id="presentationSlide"></div>
        <div class="presentation-controls">
            <button class="pres-exit-btn" id="presExit"><i class="fas fa-times"></i> Quitter</button>
        </div>
    </div>

    <div class="tree-fullscreen" id="treeFullscreen">
        <div class="tree-header">
            <div class="tree-title">
                <i class="fas fa-project-diagram"></i>
                <span>Arborescence des slides</span>
            </div>
            <div class="tree-toolbar">
                <button class="tree-tool-btn primary" id="addSlideTreeBtn" title="Ajouter une slide">
                    <i class="fas fa-plus"></i> Nouvelle slide
                </button>

                <button class="tree-tool-btn" id="resetTreeBtn" title="Réorganiser">
                    <i class="fas fa-th"></i> Réorganiser
                </button>
                <button class="tree-tool-btn preview-btn" id="previewTreeBtn" title="Aperçu du scénario">
                    <i class="fas fa-play"></i> Aperçu
                </button>
                
                <div class="zoom-controls">
                    <button class="tree-tool-btn" id="zoomOutBtn" title="Dézoomer">
                        <i class="fas fa-search-minus"></i>
                    </button>
                    <span class="zoom-level" id="zoomLevel">100%</span>
                    <button class="tree-tool-btn" id="zoomInBtn" title="Zoomer">
                        <i class="fas fa-search-plus"></i>
                    </button>
                    <button class="tree-tool-btn" id="zoomResetBtn" title="Réinitialiser le zoom">
                        <i class="fas fa-compress-arrows-alt"></i>
                    </button>
                </div>
            </div>
            <button class="tree-close-btn" id="closeTreeBtn">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="tree-canvas" id="treeCanvas">
            <svg class="tree-svg" id="treeSvg"></svg>
            <div class="tree-nodes" id="treeNodes"></div>
        </div>
        
        <div class="tree-help">
            <span><i class="fas fa-arrows-alt"></i> Glisser l'icône ☰ pour déplacer</span>
            <span><i class="fas fa-link"></i> Les connexions sont créées automatiquement via les liens de navigation</span>
            <span><i class="fas fa-hand-pointer"></i> Double-clic pour éditer</span>
        </div>
    </div>

    <div id="scenarioPreviewOverlay" class="scenario-preview-overlay hidden">
        <div class="preview-header">
            <button id="scenarioPreviewBack"><i class="fas fa-arrow-left"></i> Retour</button>
            <button id="closeScenarioPreview"><i class="fas fa-times"></i> Fermer</button>
        </div>
        <div id="scenarioPreviewCard" class="preview-card">
            <h2 id="scenarioPreviewTitle">Titre</h2>
            <div id="scenarioPreviewBody">Contenu</div>
            <div id="scenarioPreviewChoices" class="preview-choices"></div>
        </div>
    </div>

    <script type="module" src="script.js"></script>
</body>
</html>